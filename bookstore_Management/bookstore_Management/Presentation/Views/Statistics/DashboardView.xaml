<UserControl x:Class="bookstore_Management.Presentation.Views.Statistics.DashboardView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
             xmlns:enums="clr-namespace:bookstore_Management.Core.Enums"
             Background="{StaticResource BackgroundBrush}">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Presentation/AppResources/Styles/StatisticStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>


    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Header with Advanced Time Filter -->
            <Grid Grid.Row="0" Margin="0,0,0,25">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Title Section -->
                <Grid Grid.Row="0" Margin="0,0,0,15">
                    <StackPanel>
                        <TextBlock Text="THỐNG KÊ TỔNG QUAN" 
                                   Style="{StaticResource PageTitle}"/>
                        <TextBlock Text="Tổng hợp dữ liệu kinh doanh và phân tích xu hướng"
                                   FontSize="13"
                                   Foreground="#999999"
                                   Margin="0,0,0,0"/>
                    </StackPanel>

                    <!-- Refresh Button -->
                    <!--<Border Background="{StaticResource PrimaryBrush}"
                            CornerRadius="10"
                            Padding="15,8"
                            Cursor="Hand"
                            HorizontalAlignment="Right"
                            Margin="0,0,0,0"
                            Height="35">
                        --><!--<Button BorderThickness ="0" Background ="Transparent">
                            --><!--Command ="{Binding RefreshCommand}"--><!--
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,0">

                                <TextBlock Text="🔄"
                                           FontSize="14"
                                           Margin="0,0,5,0"/>
                                <TextBlock Text="Làm mới"
                                           FontSize="13"
                                           Foreground="White"
                                           FontWeight="SemiBold"
                                           VerticalAlignment="Center"/>

                            </StackPanel>
                        </Button>--><!--
                    </Border>-->
                </Grid>

                <Border Grid.Row="1"
                        Background="White"
                        CornerRadius="15"
                        BorderBrush="#E0E0E0"
                        BorderThickness="1"
                        Padding="20">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0" 
                                 Orientation="Horizontal"
                                 VerticalAlignment="Center">
                            <TextBlock Text="📅" 
                                    FontSize="20"
                                    VerticalAlignment="Center"
                                    Margin="0,0,15,0"/>
                            <TextBlock Text="Xem nhanh:" 
                                    FontSize="13"
                                    Foreground="#666666"
                                    FontWeight="SemiBold"
                                    VerticalAlignment="Center"
                                    Margin="0,0,10,0"/>


                            <Button Command="{Binding SelectTimeCommand}" 
                                    CommandParameter="{x:Static enums:TimeRange.Today}"
                                    Background="Transparent" BorderThickness="0">
                                <Border CornerRadius="8" Padding="12,6" Margin="0,0,8,0" Cursor="Hand">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Background" Value="#F5F5F5"/>
                                            <Setter Property="TextElement.Foreground" Value="#666666"/>

                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SelectedTimeRange}" Value="{x:Static enums:TimeRange.Today}">
                                                    <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
                                                    <Setter Property="TextElement.Foreground" Value="White"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>

                                    <TextBlock Text="Hôm nay" FontSize="12" FontWeight="SemiBold"/>
                                </Border>
                            </Button>

                            <Button Command="{Binding SelectTimeCommand}" 
                                    CommandParameter="{x:Static enums:TimeRange.ThisWeek}"
                                    Background="Transparent" BorderThickness="0">
                                <Border CornerRadius="8" Padding="12,6" Margin="0,0,8,0" Cursor="Hand">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Background" Value="#F5F5F5"/>
                                            <Setter Property="TextElement.Foreground" Value="#666666"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SelectedTimeRange}" Value="{x:Static enums:TimeRange.ThisWeek}">
                                                    <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
                                                    <Setter Property="TextElement.Foreground" Value="White"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <TextBlock Text="Tuần này" FontSize="12" FontWeight="SemiBold"/>
                                </Border>
                            </Button>

                            <Button Command="{Binding SelectTimeCommand}" 
                                    CommandParameter="{x:Static enums:TimeRange.ThisMonth}"
                                    Background="Transparent" BorderThickness="0">
                                <Border CornerRadius="8" Padding="12,6" Margin="0,0,8,0" Cursor="Hand">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Background" Value="#F5F5F5"/>
                                            <Setter Property="TextElement.Foreground" Value="#666666"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SelectedTimeRange}" Value="{x:Static enums:TimeRange.ThisMonth}">
                                                    <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
                                                    <Setter Property="TextElement.Foreground" Value="White"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <TextBlock Text="Tháng này" FontSize="12" FontWeight="SemiBold"/>
                                </Border>
                            </Button>

                            <Button Command="{Binding SelectTimeCommand}" 
                                      CommandParameter="{x:Static enums:TimeRange.ThisQuarter}"
                                      Background="Transparent" BorderThickness="0">
                                <Border CornerRadius="8" Padding="12,6" Margin="0,0,8,0" Cursor="Hand">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Background" Value="#F5F5F5"/>
                                            <Setter Property="TextElement.Foreground" Value="#666666"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SelectedTimeRange}" Value="{x:Static enums:TimeRange.ThisQuarter}">
                                                    <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
                                                    <Setter Property="TextElement.Foreground" Value="White"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <TextBlock Text="Quý này" FontSize="12" FontWeight="SemiBold"/>
                                </Border>
                            </Button>

                            <Button Command="{Binding SelectTimeCommand}" 
                                      CommandParameter="{x:Static enums:TimeRange.ThisYear}"
                                      Background="Transparent" BorderThickness="0">
                                <Border CornerRadius="8" Padding="12,6" Margin="0,0,8,0" Cursor="Hand">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Background" Value="#F5F5F5"/>
                                            <Setter Property="TextElement.Foreground" Value="#666666"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SelectedTimeRange}" Value="{x:Static enums:TimeRange.ThisYear}">
                                                    <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
                                                    <Setter Property="TextElement.Foreground" Value="White"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <TextBlock Text="Năm này" FontSize="12" FontWeight="SemiBold"/>
                                </Border>
                            </Button>

                            <Button Command="{Binding SelectTimeCommand}" 
                                      CommandParameter="{x:Static enums:TimeRange.ThePast30Days}"
                                      Background="Transparent" BorderThickness="0">
                                <Border CornerRadius="8" Padding="12,6" Margin="0,0,8,0" Cursor="Hand">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Background" Value="#F5F5F5"/>
                                            <Setter Property="TextElement.Foreground" Value="#666666"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SelectedTimeRange}" Value="{x:Static enums:TimeRange.ThePast30Days}">
                                                    <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
                                                    <Setter Property="TextElement.Foreground" Value="White"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <TextBlock Text="30 ngày qua" FontSize="12" FontWeight="SemiBold"/>
                                </Border>
                            </Button>

                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>

            <!-- Key Performance Indicators with Time Period Display -->
            <Grid Grid.Row="1" Margin="0,0,0,25">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Current Period Display -->
                <Border Grid.Row="0" 
                        Background="#F5F5F5"
                        CornerRadius="10"
                        Padding="15,10"
                        Margin="0,0,0,15">
                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Center">
                        <TextBlock Text="📊" 
                                   FontSize="16"
                                   Margin="0,0,8,0"
                                   VerticalAlignment="Center"/>
                        <TextBlock Text="Đang xem: "
                                   FontSize="13"
                                   Foreground="#666666"
                                   VerticalAlignment="Center"/>
                        <TextBlock Text="{Binding CurrentPeriodText}"
                                   FontSize="13"
                                   FontWeight="Bold"
                                   Foreground="{StaticResource PrimaryBrush}"
                                   VerticalAlignment="Center"
                                   Margin="3,0,0,0"/>
                        <TextBlock Text=" • "
                                   FontSize="13"
                                   Foreground="#CCCCCC"
                                   Margin="8,0,8,0"
                                   VerticalAlignment="Center"/>
                        <TextBlock FontSize="13"
                                   Foreground="#666666"
                                   VerticalAlignment="Center">
                            <Run Text="Từ"/>
                            <Run Text="{Binding From, StringFormat='{}{0:dd/MM/yyyy}'}"/>
                            <Run Text=" đến "/>
                            <Run Text="{Binding To, StringFormat='{}{0:dd/MM/yyyy}'}"/>

                        </TextBlock>
                    </StackPanel>
                </Border>

                <!-- KPI Cards -->
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="15"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="15"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="15"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- KPI 1: Doanh thu -->
                    <Border Grid.Column="0" 
                        Background="White"
                        CornerRadius="15"
                        BorderBrush="#E0E0E0"
                        BorderThickness="1"
                        Padding="20">
                        <Border.Effect>
                            <DropShadowEffect Color="#000000" BlurRadius="10" ShadowDepth="2" Opacity="0.08"/>
                        </Border.Effect>
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                <Border Background="#E8F5E9"
                                    CornerRadius="10"
                                    Width="40" Height="40"
                                    Margin="0,0,12,0">
                                    <TextBlock Text="💰" 
                                           FontSize="20"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                                </Border>
                                <StackPanel VerticalAlignment="Center">
                                    <TextBlock Text="Doanh thu"
                                           FontSize="12"
                                           Foreground="#999999"
                                           Margin="0,0,0,2"/>
                                    <TextBlock Text="{Binding PeriodLabel}"
                                           FontSize="11"
                                           Foreground="#666666"
                                           FontWeight="Medium"/>
                                </StackPanel>
                            </StackPanel>
                            <TextBlock Text="{Binding TodayRevenue, StringFormat={}{0:N0} ₫}"
                                   FontSize="20"
                                   FontWeight="Bold"
                                   Foreground="#4CAF50"
                                   Margin="0,0,0,8"/>
                            <Border Background="#E8F5E9"
                                CornerRadius="6"
                                Padding="8,4"
                                HorizontalAlignment="Left">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding RevenueTrendIcon}" 
                                           FontSize="10"
                                           Foreground="#4CAF50"
                                           Margin="0,0,3,0"/>
                                    <TextBlock Text="{Binding RevenueTrendText}"
                                           FontSize="11"
                                           Foreground="#4CAF50"
                                           FontWeight="SemiBold"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>

                    <!-- KPI 2: Đơn hàng -->
                    <Border Grid.Column="2" 
                        Background="White"
                        CornerRadius="15"
                        BorderBrush="#E0E0E0"
                        BorderThickness="1"
                        Padding="20">
                        <Border.Effect>
                            <DropShadowEffect Color="#000000" BlurRadius="10" ShadowDepth="2" Opacity="0.08"/>
                        </Border.Effect>
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                <Border Background="#E3F2FD"
                                    CornerRadius="10"
                                    Width="40" Height="40"
                                    Margin="0,0,12,0">
                                    <TextBlock Text="📦" 
                                           FontSize="20"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                                </Border>
                                <StackPanel VerticalAlignment="Center">
                                    <TextBlock Text="Đơn hàng"
                                           FontSize="12"
                                           Foreground="#999999"
                                           Margin="0,0,0,2"/>
                                    <TextBlock Text="{Binding PeriodLabel}"
                                           FontSize="11"
                                           Foreground="#666666"
                                           FontWeight="Medium"/>
                                </StackPanel>
                            </StackPanel>
                            <TextBlock Text="{Binding TodayOrders}"
                                   FontSize="20"
                                   FontWeight="Bold"
                                   Foreground="#2196F3"
                                   Margin="0,0,0,8"/>
                            <Border Background="#E3F2FD"
                                CornerRadius="6"
                                Padding="8,4"
                                HorizontalAlignment="Left">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding OrdersTrendIcon}" 
                                           FontSize="10"
                                           Foreground="#2196F3"
                                           Margin="0,0,3,0"/>
                                    <TextBlock Text="{Binding OrdersTrendText}"
                                           FontSize="11"
                                           Foreground="#2196F3"
                                           FontWeight="SemiBold"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>

                    <!-- KPI 3: Khách hàng mới -->
                    <Border Grid.Column="4" 
                        Background="White"
                        CornerRadius="15"
                        BorderBrush="#E0E0E0"
                        BorderThickness="1"
                        Padding="20">
                        <Border.Effect>
                            <DropShadowEffect Color="#000000" BlurRadius="10" ShadowDepth="2" Opacity="0.08"/>
                        </Border.Effect>
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                <Border Background="#FFF3E0"
                                    CornerRadius="10"
                                    Width="40" Height="40"
                                    Margin="0,0,12,0">
                                    <TextBlock Text="👥" 
                                           FontSize="20"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                                </Border>
                                <StackPanel VerticalAlignment="Center">
                                    <TextBlock Text="Khách hàng mới"
                                           FontSize="12"
                                           Foreground="#999999"
                                           Margin="0,0,0,2"/>
                                    <TextBlock Text="{Binding PeriodLabel}"
                                           FontSize="11"
                                           Foreground="#666666"
                                           FontWeight="Medium"/>
                                </StackPanel>
                            </StackPanel>
                            <TextBlock Text="{Binding NewCustomers}"
                                   FontSize="20"
                                   FontWeight="Bold"
                                   Foreground="#FF9800"
                                   Margin="0,0,0,8"/>
                            <Border Background="#FFF3E0"
                                CornerRadius="6"
                                Padding="8,4"
                                HorizontalAlignment="Left">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding CustomersTrendIcon}" 
                                           FontSize="10"
                                           Foreground="#FF9800"
                                           Margin="0,0,3,0"/>
                                    <TextBlock Text="{Binding CustomersTrendText}"
                                           FontSize="11"
                                           Foreground="#FF9800"
                                           FontWeight="SemiBold"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>

                    <!-- KPI 4: Sách sắp hết -->
                    <Border Grid.Column="6" 
                        Background="White"
                        CornerRadius="15"
                        BorderBrush="#E0E0E0"
                        BorderThickness="1"
                        Padding="20">
                        <Border.Effect>
                            <DropShadowEffect Color="#000000" BlurRadius="10" ShadowDepth="2" Opacity="0.08"/>
                        </Border.Effect>
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                <Border Background="#FFEBEE"
                                    CornerRadius="10"
                                    Width="40" Height="40"
                                    Margin="0,0,12,0">
                                    <TextBlock Text="⚠️" 
                                           FontSize="20"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                                </Border>
                                <StackPanel VerticalAlignment="Center">
                                    <TextBlock Text="Tồn kho thấp"
                                           FontSize="12"
                                           Foreground="#999999"
                                           Margin="0,0,0,2"/>
                                    <TextBlock Text="Cần nhập hàng"
                                           FontSize="11"
                                           Foreground="#666666"
                                           FontWeight="Medium"/>
                                </StackPanel>
                            </StackPanel>
                            <TextBlock Text="{Binding LowStockBooks, StringFormat={}{0} đầu sách}"
                                   FontSize="20"
                                   FontWeight="Bold"
                                   Foreground="#F44336"
                                   Margin="0,0,0,8"/>
                            <Border Background="#FFEBEE"
                                CornerRadius="6"
                                Padding="8,4"
                                HorizontalAlignment="Left"
                                Cursor="Hand">
                                <Border.InputBindings>
                                    <MouseBinding Gesture="LeftClick"
                                                 Command="{Binding ShowOutOfStockDetailCommand}"/>
                                </Border.InputBindings>
                                <TextBlock Text="Xem chi tiết →"
                                       FontSize="11"
                                       Foreground="#F44336"
                                       FontWeight="SemiBold"/>
                            </Border>
                        </StackPanel>
                    </Border>
                </Grid>
            </Grid>

            <!-- Charts Section -->
            <Grid Grid.Row="2" Margin="0,0,0,20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="20"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Revenue Trend Chart -->
                <Border Grid.Column="0" Style="{StaticResource StatCardBorder}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Header -->
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15">
                            <Border Background="#E8F5E9"
                                    CornerRadius="10"
                                    Width="40" Height="40"
                                    Margin="0,0,12,0">
                                <TextBlock Text="📈" FontSize="20" 
                                           HorizontalAlignment="Center" 
                                           VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="Doanh thu " 
                                           Style="{StaticResource CardHeaderText}"
                                           Margin="0,0,0,2"/>
                                <TextBlock Text="Tổng thu / ngày"
                                           FontSize="12"
                                           Foreground="#999999"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Line Chart -->
                        <lvc:CartesianChart Grid.Row="1" 
                                            Series="{Binding RevenueSeries}"
                                            LegendLocation="None"
                                            Height="280"
                                            Margin="0,10,0,0">
                            <lvc:CartesianChart.AxisY>
                                <lvc:Axis Title="Doanh thu (Triệu VNĐ)" 
                                          FontSize="11"
                                          Foreground="{StaticResource AxisTextBrush}"/>
                            </lvc:CartesianChart.AxisY>
                            <lvc:CartesianChart.AxisX>
                                <lvc:Axis Labels="{Binding RevenueLabels}"
                                          FontSize="10"
                                          Foreground="{StaticResource AxisTextBrush}"/>
                            </lvc:CartesianChart.AxisX>
                        </lvc:CartesianChart>
                    </Grid>
                </Border>

                <!-- Top Categories Chart -->
                <Border Grid.Column="2" Style="{StaticResource StatCardBorder}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Header -->
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15">
                            <Border Background="#FFF3E0"
                                    CornerRadius="10"
                                    Width="40" Height="40"
                                    Margin="0,0,12,0">
                                <TextBlock Text="📊" FontSize="20" 
                                           HorizontalAlignment="Center" 
                                           VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="Sách bán chạy" 
                                           Style="{StaticResource CardHeaderText}"
                                           Margin="0,0,0,2"/>
                                <TextBlock Text="Top 5"
                                           FontSize="12"
                                           Foreground="#999999"/>
                            </StackPanel>
                        </StackPanel>

                        <lvc:CartesianChart Grid.Row="1"
                            Series="{Binding CategorySeries}"
                            LegendLocation="Bottom"
                            Height="200"
                            Margin="0,10,0,10">

                            <lvc:CartesianChart.AxisY>
                                <lvc:Axis ShowLabels="False"/>
                            </lvc:CartesianChart.AxisY>

                            <lvc:CartesianChart.AxisX>
                                <lvc:Axis ShowLabels="False"/>
                            </lvc:CartesianChart.AxisX>

                        </lvc:CartesianChart>
                        
                    </Grid>
                </Border>
            </Grid>

            <!-- Bottom Section: Customer Distribution & Profit/Cost -->
            <Grid Grid.Row="3">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="20"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Customer Distribution Card -->
                <Border Grid.Column="0" Style="{StaticResource StatCardBorder}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Header -->
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15">
                            <Border Background="#E3F2FD"
                                    CornerRadius="10"
                                    Width="40" Height="40"
                                    Margin="0,0,12,0">
                                <TextBlock Text="👥" FontSize="20" 
                                           HorizontalAlignment="Center" 
                                           VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="Phân loại Khách hàng" 
                                           Style="{StaticResource CardHeaderText}"
                                           Margin="0,0,0,2"/>
                                <TextBlock Text="Thành viên vs Vãng lai"
                                           FontSize="12"
                                           Foreground="#999999"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Pie Chart -->
                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <lvc:PieChart Grid.Column="0"
                                          Series="{Binding CustomerSeries}"
                                          LegendLocation="None"
                                          InnerRadius="70"
                                          Height="220"
                                          Margin="0,10,0,0"/>

                            <!-- Legend & Stats -->
                            <StackPanel Grid.Column="1" 
                                        VerticalAlignment="Center"
                                        Margin="30,0,0,0">

                                <!-- Total Customers -->
                                <Border Background="#F5F5F5"
                                        CornerRadius="12"
                                        Padding="15"
                                        Margin="0,0,0,20">
                                    <StackPanel>
                                        <TextBlock Text="👥" 
                                                   FontSize="24" 
                                                   HorizontalAlignment="Center"/>
                                        <TextBlock Text="{Binding TotalCustomers}" 
                                                   FontSize="28"
                                                   FontWeight="Bold"
                                                   Foreground="{StaticResource PrimaryBrush}"
                                                   HorizontalAlignment="Center"
                                                   Margin="0,5,0,3"/>
                                        <TextBlock Text="Tổng khách hàng" 
                                                   FontSize="11"
                                                   Foreground="#999999"
                                                   HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>

                                <!-- Member -->
                                <StackPanel Margin="0,0,0,12">
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <Ellipse Width="12" Height="12" 
                                                 Fill="{StaticResource PieChartMemberBrush}"
                                                 Margin="0,0,8,0"/>
                                        <TextBlock Text="Thành Viên" 
                                                   FontSize="13"
                                                   Foreground="#666666"
                                                   FontWeight="Medium"/>
                                    </StackPanel>
                                    <TextBlock Text="{Binding Member}" 
                                               FontSize="12"
                                               FontWeight="Bold"
                                               Foreground="{StaticResource PrimaryBrush}"
                                               Margin="20,0,0,0"/>
                                </StackPanel>

                                <!-- Regular -->
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <Ellipse Width="12" Height="12" 
                                                 Fill="{StaticResource PieChartRegularBrush}"
                                                 Margin="0,0,8,0"/>
                                        <TextBlock Text="Vãng Lai" 
                                                   FontSize="13"
                                                   Foreground="#666666"
                                                   FontWeight="Medium"/>
                                    </StackPanel>
                                    <TextBlock Text="{Binding WalkIn}" 
                                               FontSize="12"
                                               FontWeight="Bold"
                                               Foreground="#666666"
                                               Margin="20,0,0,0"/>
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </Grid>
                </Border>

                <!-- Profit/Cost Chart Card -->
                <Border Grid.Column="2" Style="{StaticResource StatCardBorder}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Header -->
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15">
                            <Border Background="#F3E5F5"
                                    CornerRadius="10"
                                    Width="40" Height="40"
                                    Margin="0,0,12,0">
                                <TextBlock Text="💰" FontSize="20" 
                                           HorizontalAlignment="Center" 
                                           VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="Chi phí" 
                                           Style="{StaticResource CardHeaderText}"
                                           Margin="0,0,0,2"/>
                                <TextBlock Text="Tổng chi / ngày"
                                           FontSize="12"
                                           Foreground="#999999"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Horizontal Bar Chart -->
                        <lvc:CartesianChart Grid.Row="1" 
                                            Series="{Binding ProfitSeries}"
                                            Height="280"
                                            Margin="0,10,0,0">
                            <lvc:CartesianChart.AxisY>
                                <lvc:Axis Labels="{Binding ProfitLabels}"
                                          FontSize="12"
                                          Foreground="{StaticResource LegendTextBrush}"
                                          FontWeight="Medium"/>
                            </lvc:CartesianChart.AxisY>
                            <lvc:CartesianChart.AxisX>
                                <lvc:Axis FontSize="11"
                                          Foreground="{StaticResource AxisTextBrush}"/>
                                <!--LabelFormatter="{Binding ProfitCostFormatter}"/>-->
                            </lvc:CartesianChart.AxisX>
                        </lvc:CartesianChart>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
    </ScrollViewer>
</UserControl>